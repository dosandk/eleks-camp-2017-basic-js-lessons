<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>JS Constructions</title>
</head>

<body>
    <script>
        // 1. ImmutableArray        
        let initArray = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
        let ImmutableArray = {
            push(arr, el) {
                return [].concat(arr.slice(), el);
            },
            pop(arr) {
                let arrCopy = arr.slice()
                arrCopy.length = arr.length - 1;
                return arrCopy;
            },
            shift(arr) {
                return arr.slice(1);
            },
            unshift(arr, el) {
                let arrCopy = [];
                arrCopy[0] = el;
                return arrCopy.concat(arr.slice(1));
            },
            remove(arr, index) {
                return arr.slice(0, index).concat(arr.slice(index + 1))
            },
            insert(arr, el, index) {
                return arr.slice(0, index).concat(el, arr.slice(index))
            },
            swapElements(arr, direction, index) {
                function ckeckSwapDirection(curInd, prevInd, nextInd, curElem, prevElem, nextElem) {
                    if (direction == 'prev') {
                        arrayCopy[curInd] = prevElem;
                        arrayCopy[prevInd] = curElem;
                    } else if (direction == 'next') {
                        arrayCopy[curInd] = nextElem;
                        arrayCopy[nextInd] = curElem;
                    }
                }

                let arrayCopy = arr.slice(),
                    amountOfElems = arr.length;

                if (index > amountOfElems - 1) {
                    index = amountOfElems - 1;
                    ckeckSwapDirection(index, index - 1, 0, arr[index], arr[index - 1], arr[0])
                } else if (index <= 0) {
                    index = 0;
                    ckeckSwapDirection(index, amountOfElems - 1, index + 1, arr[index], arr[amountOfElems - 1], arr[index + 1])
                } else {
                    ckeckSwapDirection(index, index - 1, index + 1, arr[index], arr[index - 1], arr[index + 1])
                }
                return arrayCopy;
            },
            swapWithPrevious(arr, index) {
                return this.swapElements(arr, 'prev', index);
            },
            swapWithNext(arr, index) {
                return this.swapElements(arr, 'next', index);
            },

        }
        // console.log('1. ImmutableArray')
        // console.log('push', ImmutableArray.push(initArray, 55))
        // console.log('pop', ImmutableArray.pop(initArray))
        // console.log('shift', ImmutableArray.shift(initArray))
        // console.log('unshift', ImmutableArray.unshift(initArray, 10))
        // console.log('remove', ImmutableArray.remove(initArray, 1))
        // console.log('insert', ImmutableArray.insert(initArray, 100, 1))
        // console.log('swapWithPrevious', ImmutableArray.swapWithPrevious(initArray, 10))
        // console.log('swapWithNext', ImmutableArray.swapWithNext(initArray, 10))
        // console.log('initArray', initArray)



        // 2. intersection(arr1, arr2)
        function intersection(arr1, arr2) {
            let resultArr = [];
            arr1.forEach(function (elem1) {
                arr2.forEach(function (elem2) {
                    if (elem1 == elem2 && resultArr.indexOf(elem1) == -1) {
                        resultArr.push(elem1);
                    }
                })
            })
            return resultArr.sort(function (a, b) { return a - b });
        }
        // console.log('2. intersection(arr1, arr2)')
        // console.log('intersection', intersection([2, 1, 3, 1], [1, 3, 5]))



        // 3. vowelCount(`Hello WORLD!`)
        function vowelCount(str) {
            return str.match(/[aeiouy]/gi).length;
        }
        // console.log('3. vowelCount(`Hello WORLD!`)')
        // console.log('3. vowelCount', vowelCount(`Hello WORLD!`))



        // 4. toEvenOddString([1, 3, 2, 8, 13, 7, 4])
        function toEvenOddString(arr) {
            let evenArr = [],
                oddArr = [];
            arr.forEach(function (elem) {
                if (elem % 2) {
                    oddArr.push(elem)
                } else {
                    evenArr.push(elem)
                }
            })
            return evenArr.sort(function (a, b) { return a - b }).join('') + oddArr.sort(function (a, b) { return b - a }).join('');
        }
        // console.log('4. toEvenOddString([1, 3, 2, 8, 13, 7, 4])')
        // console.log('result', toEvenOddString([1, 3, 2, 8, 13, 7, 4]))



        // 5. snail(arr)
        let snailArr = [
            [1, 2, 3, 4, 5],
            [12, 13, 14, 15, 6],
            [11, 10, 9, 8, 7]
        ]
        let resultArr = [];
        
        function snail(arr) {
            let amountOfElems = arr[0].length;

            for (let i = 0; i < amountOfElems; i++) {
                resultArr.push(arr[0].shift());
            }
            arr.shift();
            turnArray(arr)
        }
        
        function turnArray(arr) {
            if (arr.length) {
                let n = arr.length - 1,
                    m = arr[0].length - 1,
                    newArray = [];

                for (let i = 0; i <= m; i++) {
                    let tempArr = [];
                    for (let j = 0; j <= n; j++) {
                        tempArr.unshift(arr[n - j][m - i])
                    }
                    newArray.push(tempArr)
                }
            snail(newArray)
            }
        }

        snail(snailArr)
        console.log(resultArr)


        // 6. Complex task with arrays
        let monday = [
            {
                'name': 'Write a tutorial',
                'duration': 180
            },
            {
                'name': 'Some web development',
                'duration': 120
            }
        ]

        let tuesday = [
            {
                'name': 'Keep writing that tutorial',
                'duration': 240
            },
            {
                'name': 'Some more web development',
                'duration': 180
            },
            {
                'name': 'A whole lot of nothing',
                'duration': 240
            }
        ]

        let tasks = [monday, tuesday];
        const TIME_RATE = 15;
        let totalRate = 0;
        // 6.1 Combine tasks array of objects from two days
        tasks.reduce(function (prevItem, currentItem) {
            for (let obj of currentItem) {
                prevItem.push(obj)
            }
            tasks = prevItem;
        })
        // console.log('6.1. Combine tasks array', tasks)

        // 6.2 Remake tasks duration from minutes to hours
        tasks.map(function (el) {
            el.duration = el.duration / 60;
        })
        // console.log('6.2. Remake tasks duration', tasks)

        // 6.3 Filter tasks where task duration > 2 hours
        tasks.filter(function (el, index) {
            if (el.duration <= 2) {
                tasks.splice(index, 1)
            }
        })
        // console.log('6.3. Filter tasks duration', tasks)

        // 6.4-6.6 Calculate tasks rate. Calculate total tasks rate and format output value 
        tasks.map(function (el) {
            el['rate'] = el.duration * TIME_RATE;
            totalRate += el['rate'];
        })
        totalRate += '$';
        // console.log('6.4. Calculate tasks rate', tasks)
        // console.log('6.5-6.6. Calculate total tasks rate', totalRate)
    </script>
</body>

</html>